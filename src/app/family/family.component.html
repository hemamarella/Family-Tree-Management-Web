<div class="container Center">
    <form [formGroup]="familyForm" (ngSubmit)="onSubmit()" class="family-form">
      <h2 class="form-title">Add Family </h2>

      <div class="col-md-12 mb-3">
        <label class="form-label">User Name</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-person"></i></span>
          <input 
            type="text" 
            class="form-control"
            formControlName="username" 
            readonly>
        </div>
      </div>
      
  
      <!-- Surname Input -->
      <div class="form-group">
        <label for="Surname">Surname*</label>
        <input
          id="Surname"
          class="form-control"
          formControlName="Surname"
          placeholder="Enter surname"
          [ngClass]="{
            'border-danger': familyForm.get('Surname')?.touched && familyForm.get('Surname')?.invalid
          }"
        />
        <div *ngIf="familyForm.get('Surname')?.touched && familyForm.get('Surname')?.invalid" class="text-danger">
          <div *ngIf="familyForm.get('Surname')?.hasError('required')">Surname is Required.</div>
          <div *ngIf="familyForm.get('Surname')?.hasError('surnameTaken')">This surname is already taken. Please choose a different one.</div>
        </div>
      </div>
  
      <!-- Family Color Input -->
      <div class="form-group">
        <label for="Color">Family Color*</label>
        <input
          id="Color"
          type="color"
          class="form-control"
          formControlName="Color"
          [ngClass]="{
            'border-danger': familyForm.get('Color')?.touched && familyForm.get('Color')?.invalid
          }"
        />
        <div *ngIf="familyForm.get('Color')?.touched && familyForm.get('Color')?.invalid" class="text-danger">
          Color is Required.
        </div>
      </div>
  
      <!-- Description Input -->
      <div class="form-group">
        <label for="Description">Description</label>
        <textarea
          id="Description"
          class="form-control"
          formControlName="Description"
          placeholder="Enter description"
        ></textarea>
      </div>
  
      <!-- Head of the Family Input -->
      <div class="form-group">
        <label for="HeadOfTheFamily">Head of the Family*</label>
        <input
          id="HeadOfTheFamily"
          class="form-control"
          formControlName="HeadOfTheFamily"
          placeholder="Enter the name"
          [ngClass]="{
            'border-danger': familyForm.get('HeadOfTheFamily')?.touched && familyForm.get('HeadOfTheFamily')?.invalid
          }"
        />
        <div *ngIf="familyForm.get('HeadOfTheFamily')?.touched && familyForm.get('HeadOfTheFamily')?.invalid" class="text-danger">
          Head of the Family is Required.
        </div>
      </div>
  
      <!-- Date of Birth Input -->
      <div class="form-group">
        <label for="DOB">Date of Birth*</label>
        <input
          id="DOB"
          type="date"
          class="form-control"
          formControlName="DOB"
          [ngClass]="{
            'border-danger': familyForm.get('DOB')?.touched && familyForm.get('DOB')?.invalid
          }"
        />
        <div *ngIf="familyForm.get('DOB')?.touched && familyForm.get('DOB')?.invalid" class="text-danger">
          <div *ngIf="familyForm.get('DOB')?.hasError('required')">Date of Birth is required.</div>
          <div *ngIf="familyForm.get('DOB')?.hasError('min')">Date of Birth must be after January 1, 1900.</div>
          <div *ngIf="familyForm.get('DOB')?.hasError('max')">Date of Birth cannot be a future date.</div>
        </div>
      </div>
  
      <!-- Gender Input -->
      <div class="form-group">
        <label for="Gender">Gender*</label>
        <select
          id="Gender"
          class="form-control"
          formControlName="Gender"
          [ngClass]="{
            'border-danger': familyForm.get('Gender')?.touched && familyForm.get('Gender')?.invalid
          }"
        >
          <option value="" disabled selected>Select Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
        <div *ngIf="familyForm.get('Gender')?.touched && familyForm.get('Gender')?.invalid" class="text-danger">
          Gender is Required.
        </div>
      </div>
  
      <!-- Member Photo Input -->
      <div class="form-group">
        <label for="Memberphoto">Member Photo</label>
        <input
          type="file"
          class="form-control"
          formControlName="FamilyHeadImageDefault"  
          (change)="onFileChange($event)"
        />
      </div>
  
      <!-- Submit and Cancel buttons -->
      <div class="form-group">
        <button type="submit" class="btn btn-primary">Submit</button>
        <button type="button" class="btn btn-secondary" (click)="onClear()">Clear</button>
      </div>
    </form>
  
    <!-- Modal for Success/Error Message -->
    <div class="modal" tabindex="-1" [ngClass]="{'show': submitMessage !== ''}" *ngIf="submitMessage">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">{{ isSubmittedSuccessfully ? 'Success' : 'Error' }}</h5>
            <button type="button" class="btn-close" (click)="closeModal()"></button>
          </div>
          <div class="modal-body">
            <p>{{ submitMessage }}</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="closeModal()">OK</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  